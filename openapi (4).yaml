openapi: 3.0.0
info:
  title: My API
  version: v1
paths:
  /users/login:
    post:
      tags: 
        - users
      summary: Авторизация пользователя в системе.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: Email пользователя
                password:
                  type: string
                  description: Пароль пользователя
      responses:
        '200':
          description: Авторизация пользователя выполнена успешно
          content:
            application/json:
              schema:
                type: object
                properties:
                  token: 
                    type: string
                    description: Токен авторизации
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                        format: string
                      name:
                        type: string
                      email:
                        type: string
                      phonenum:
                        type: string
        '401':
          description: Неверный email или пароль
  /users/reg:
    post:
      tags: 
        - users
      summary: Регистрация нового пользователя в системе.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: Email пользователя
                password:
                  type: string
                  description: Пароль пользователя
                name:
                  type: string
                  description: Имя пользователя
                phonenum:
                  type: string
                  description: Номер телефона
      responses:
        '201':
          description: Пользователь успешно зарегистрирован
        '400':
          description: Некорректные данные регистрации
  /users:
    post:
      tags: 
        - users
      summary: Создание нового пользователя в системе.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: Email пользователя
                password:
                  type: string
                  description: Пароль пользователя
                name:
                  type: string
                  description: Имя пользователя
                phonenum:
                  type: string
                  description: Номер телефона
                role:
                  type: string
                  description: Роль пользователя
      responses:
        '201':
          description: Новый пользователь создан
          content:
            application/json:
              schema:
                type: object
                properties:
                  id: 
                    type: integer
                    format: int64
        '400':
          description: Некорректные данные для создания пользователя
  /users/{id}:
    patch:
      tags: 
        - users
      summary: Обновление данных о пользователе.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID пользователя
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: Email пользователя
                password:
                  type: string
                  description: Пароль пользователя
                name:
                  type: string
                  description: Имя пользователя
      responses:
        '200':
          description: Данные пользователя обновлены
          content:
            application/json:
              schema:
                type: object
                properties:
                  email:
                    type: string
                    description: Email пользователя
                  name:
                    type: string
                    description: Имя пользователя
                  phonenum:
                    type: string
                    description: Номер телефона
        '400':
          description: Некорректные данные для обновления пользователя
        '404':
          description: Пользователь не найден
  /users/{id}/orders:
    get:
      tags: 
        - users
      summary: Получение всех заказов пользователя по его ID.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID пользователя
      responses:
        '200':
          description: Данные о заказе получены
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      format: int64
                      description: ID заказа
                    orderposition:
                      type: array
                      description: Список позиций заказа
                      items:
                        type: object
                        properties:
                          phoneid:
                            type: integer
                            format: int64
                            description: ID телефона
                          amount:
                            type: integer
                            format: int32
                            description: Количество телефонов в позиции
                    status:
                      type: integer
                      description: Статус заказа
                    userid:
                      type: integer
                      format: int64
                      description: ID пользователя
        '404':
          description: Заказы не найдены
  /users/{id}/basket:
    get:
      tags: 
        - users
      summary: Получение данных о корзине по ID пользователя.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID пользователя
      responses:
        '200':
          description: Данные о корзине получены
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                      description: ID корзины
                    basketpositions:
                      type: array
                      description: Список позиций корзины
                      items:
                        type: object
                        properties:
                          phoneid:
                            type: string
                            description: ID телефона
                          amount:
                            type: string
                            description: Количество телефонов в позиции
        '404':
          description: Корзина не найдена
  /users/{id}/wishes:
    get:
      tags: 
        - users
      summary: Получение списка желаемых товаров по ID пользователя.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID пользователя
      responses:
        '200':
          description: Список желаемых товаров получен
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    wishes:
                      type: array
                      description: Список желаемых товаров
                      items:
                        type: object
                        properties:
                          id:
                            type: string
                            description: id желаемого товара
                          phoneid:
                            type: string
                            description: id телефона
        '404':
          description: Товары не найдены
  
  /phones/{id}/comments:
    get:
      tags: 
        - phones
      summary: Получение комментариев по ID товара.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID товара
      responses:
        '200':
          description: Список комментариев получен
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    comments:
                      type: array
                      description: Список комментариев
                      items:
                        type: object
                        properties:
                          id:
                            type: string
                            description: id
                          userid:
                            type: string
                            description: id
                          username:
                            type: string
                          text:
                            type: string
                          rate: 
                            type: integer
                          date:
                            type: string
        '404':
          description: Товар не найден
  
  /phones/{id}:
    get:
      tags: 
        - phones
      summary: Получение данных о телефоне по его ID.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID телефона
      responses:
        '200':
          description: Данные о телефоне получены
          content:
            application/json:
              schema:
                type: object
                properties:
                  id: 
                    type: integer
                    format: int64
                  name:
                    type: string
                  osname:
                    type: string
                  prodname:
                    type: string
                  price:
                    type: number
                    format: float
                  mem:
                    type: number
                    format: float
                  ram:
                    type: number
                    format: float
                  camres:
                    type: number
                    format: float
        '404':
          description: Телефон не найден
    patch:
      tags: 
        - phones
      summary: Обновление данных о существующем телефоне.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID телефона
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  description: id телефона
                name:
                  type: string
                  description: Название телефона
                osname:
                  type: string
                  description: Название ОС
                prodname:
                  type: string
                  description: Название производителя
                price:
                  type: number
                  description: Цена телефона
                mem:
                  type: number
                  description: Размер памяти
                ram:
                  type: number
                  description: Размер озу
                camres:
                  type: number
                  description: Разрешение камеры
      responses:
        '200':
          description: Данные телефона обновлены
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    description: id телефона
                  name:
                    type: string
                    description: Название телефона
                  osname:
                    type: string
                    description: Название ОС
                  prodname:
                    type: string
                    description: Название производителя
                  price:
                    type: number
                    description: Цена телефона
                  mem:
                    type: number
                    description: Размер памяти
                  ram:
                    type: number
                    description: Размер озу
                  camres:
                    type: number
                    description: Разрешение камеры
        '400':
          description: Некорректные данные для обновления телефона
        '404':
          description: Телефон не найден
    delete:
      tags: 
        - phones
      summary: Удаление телефона.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID телефона
      responses:
        '204':
          description: Телефон успешно удален
        '404':
          description: Телефон не найден
  /phones:
    post:
      tags: 
        - phones
      summary: Создание нового телефона в системе.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Название телефона
                osname:
                  type: string
                  description: Название ОС
                prodname:
                  type: string
                  description: Название производителя
                price:
                  type: number
                  description: Цена телефона
                mem:
                  type: number
                  description: Размер памяти
                ram:
                  type: number
                  description: Размер озу
                camres:
                  type: number
                  description: Разрешение камеры
      responses:
        '201':
          description: Новый телефон создан
          content:
            application/json:
              schema:
                type: object
                properties:
                  id: 
                    type: string
                  name:
                    type: string
                    description: Название телефона
                  osname:
                    type: string
                    description: Название ОС
                  prodname:
                    type: string
                    description: Название производителя
                  price:
                    type: number
                    description: Цена телефона
                  mem:
                    type: number
                    description: Размер памяти
                  ram:
                    type: number
                    description: Размер озу
                  camres:
                    type: number
                    description: Разрешение камеры
        '400':
          description: Некорректные данные для создания телефона
    get:
      tags: 
        - phones
      summary: Получение списка телефонов с поддержкой пагинации и фильтров.
      parameters:
        - name: page
          in: query
          required: false
          description: Номер страницы для пагинации (по умолчанию 1).
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          required: false
          description: Количество объектов на странице (по умолчанию 10).
          schema:
            type: integer
            default: 10
        - name: osname
          in: query
          required: false
          description: Фильтр по названию ОС.
          schema:
            type: string
        - name: prodname
          in: query
          required: false
          description: Фильтр по названию производителя.
          schema:
            type: string
        - name: price_min
          in: query
          required: false
          description: Минимальная цена телефона.
          schema:
            type: number
        - name: price_max
          in: query
          required: false
          description: Максимальная цена телефона.
          schema:
            type: number
        - name: mem_min
          in: query
          required: false
          description: Фильтр по мин. размеру памяти.
          schema:
            type: number
        - name: mem_max
          in: query
          required: false
          description: Фильтр по макс. размеру памяти.
          schema:
            type: number
        - name: ram_min
          in: query
          required: false
          description: Фильтр по мин. размеру оперативной памяти.
          schema:
            type: number
        - name: ram_max
          in: query
          required: false
          description: Фильтр по макс. размеру оперативной памяти.
          schema:
            type: number
        - name: camres_min
          in: query
          required: false
          description: Фильтр по мин. разрешению камеры.
          schema:
            type: number
        - name: camres_max
          in: query
          required: false
          description: Фильтр по макс. разрешению камеры.
          schema:
            type: number
      responses:
        '200':
          description: Успешный ответ со списком телефонов.
          content:
            application/json:
              schema:
                type: object
                properties:
                  total_count:
                    type: integer
                    description: Общее количество найденных телефонов.
                  page:
                    type: integer
                    description: Номер текущей страницы.
                  limit:
                    type: integer
                    description: Количество объектов на странице.
                  phones:
                    type: array
                    items:
                      type: object
                      properties:
                        name:
                          type: string
                          description: Название телефона.
                        osname:
                          type: string
                          description: Название ОС.
                        prodname:
                          type: string
                          description: Название производителя.
                        price:
                          type: number
                          description: Цена телефона.
                        mem:
                          type: number
                          description: Размер памяти.
                        ram:
                          type: number
                          description: Размер озу.
                        camres:
                          type: number
                          description: Разрешение камеры.
  /orders:
    post:
      tags: 
        - orders
      summary: Создание нового заказа.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                orderposition:
                  type: array
                  description: Список позиций заказа
                  items:
                    type: object
                    properties:
                      phoneid:
                        type: integer
                        format: int64
                        description: ID телефона
                      amount:
                        type: integer
                        format: int32
                        description: Количество телефонов в позиции
      responses:
        '201':
          description: Новый заказ создан
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    format: int64
                    description: ID созданного заказа
        '400':
          description: Некорректные данные для создания заказа
    delete:
      tags: 
        - orders
      summary: Удаление заказа.
      responses:
        '204':
          description: Заказ успешно удален
        '404':
          description: Заказ не найден
  /orders/{id}:
    get:
      tags: 
        - orders
      summary: Получение данных о заказе по его ID.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID заказа
      responses:
        '200':
          description: Данные о заказе получены
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    format: int64
                    description: ID заказа
                  orderposition:
                    type: array
                    description: Список позиций заказа
                    items:
                      type: object
                      properties:
                        phoneid:
                          type: integer
                          format: int64
                          description: ID телефона
                        amount:
                          type: integer
                          format: int32
                          description: Количество телефонов в позиции
                  status:
                    type: integer
                    description: Статус заказа
                  userid:
                    type: integer
                    format: int64
                    description: ID пользователя
        '404':
          description: Заказ не найден
    patch:
      tags: 
        - orders
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID заказа
      summary: Обновление статуса заказа.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: integer
                  description: Новый статус заказа
      responses:
        '200':
          description: Данные о заказе обновлены
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    format: int64
                    description: ID заказа
                  orderposition:
                    type: array
                    description: Список позиций заказа
                    items:
                      type: object
                      properties:
                        phoneid:
                          type: integer
                          format: int64
                          description: ID телефона
                        amount:
                          type: integer
                          format: int32
                          description: Количество телефонов в позиции
                  status:
                    type: integer
                    description: Статус заказа
                  userid:
                    type: integer
                    format: int64
                    description: ID пользователя
        '400':
          description: Некорректное значение статуса заказа
        '404':
          description: Заказ не найден
  /orders/{id}/payment:
    get:
      tags: 
        - orders
      summary: Получение данных о платеже по ID заказа.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID заказа
      responses:
        '200':
          description: Платеж найден
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    description: id платежа
                  orderid:
                    type: string
                    description: id заказа
                  address:
                    type: string
                    description: адрес доставки
                  status:
                    type: boolean
                    description: статус заказа
          
        '404':
          description: Заказ не найден
  /payments/{id}:
    get:
      tags: 
        - payments
      summary: Получение данных о платеже по его ID.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID платежа
      responses:
        '200':
          description: Данные о платеже получены
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  orderid:
                    type: string
                  address:
                    type: string
                  status:
                    type: boolean
        '404':
          description: Платеж не найден
    delete:
      tags: 
        - payments
      summary: Удаление платежа.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID платежа
      responses:
        '204':
          description: Платеж успешно удален
        '404':
          description: Платеж не найден
    patch:
      tags: 
        - payments
      summary: Обновление данных о платеже.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID платежа
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                address:
                  type: string
                  description: адрес доставки
                status:
                  type: string
                  description: статус оплаты
      responses:
        '200':
          description: Данные о платеже обновлены
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  orderid:
                    type: string
                  address:
                    type: string
                  status:
                    type: boolean
        '400':
          description: Некорректные данные для обновления платежа
        '404':
          description: Платеж не найден
  /payments:
    post:
      tags: 
        - payments
      summary: Создание нового платежа.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                orderid:
                  type: string
                  description: id заказа
                address:
                  type: string
                  description: адрес доставки
      responses:
        '201':
          description: Новый платеж создан
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
        '400':
          description: Некорректные данные для создания платежа
  /baskets/{id}:
    delete:
      tags: 
        - baskets
      summary: Удаление товаров из корзины.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID корзины
        - in: query
          name: phoneids
          schema:
            type: array
            items:
              type: string
          required: true
          description: Массив ID телефонов (phoneids)
          style: form
          explode: false        
      responses:
        '200':
          description: Товары удалены из корзины
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                      description: ID корзины
                    basketposition:
                      type: array
                      description: Список позиций корзины
                      items:
                        type: object
                        properties:
                          phoneid:
                            type: string
                            description: ID телефона
                          amount:
                            type: string
                            description: Количество телефонов в позиции
        '400':
          description: Некорректные данные для удаления товара
    post:
      tags: 
        - baskets
      summary: Добавление товаров в корзину.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID корзины
      requestBody:
        content:
          application/json:
            schema:
              type: array
              items:
                type: object
                properties:
                  phoneid:
                    type: string
                    description: id телефона
      responses:
        '200':
          description: Товары добавлены в корзину
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                      description: ID корзины
                    basketposition:
                      type: array
                      description: Список позиций корзины
                      items:
                        type: object
                        properties:
                          phoneid:
                            type: string
                            description: ID телефона
                          amount:
                            type: string
                            description: Количество телефонов в позиции
        '400':
          description: Некорректные данные для добавления товара
  /baskets:
    post:
      tags: 
        - baskets
      summary: Создание новой корзины для пользователя.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                userid:
                  type: string
                  description: id корзины
      responses:
        '201':
          description: Корзина создана
        '400':
          description: Некорректные данные для создания корзины

  /baskets/{id}/price:
    get:
      tags: 
        - baskets
      summary: Получение общей суммы товаров в корзине.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID корзины
      responses:
        '200':
          description: Общая сумма товаров получена
          content:
            application/json:
              schema:
                type: number
        '404':
          description: Корзина не найдена
  
  /comments:
    post:
      tags: 
        - comments
      summary: Создание нового комментария.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                phoneid:
                  type: string
                  description: id телефона
                userid:
                  type: string
                  description: id пользователя
                text:
                  type: string
                  description: текст комментария
      responses:
        '201':
          description: Комментарий создан
        '400':
          description: Некорректные данные для создания комментария
  /comments/{id}:
    delete:
      tags: 
        - comments
      summary: Удаление комментария.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID комментария
      responses:
        '204':
          description: Комментарий успешно удален
        '404':
          description: Комментарий не найден
  /comments/{id}/rate:
    patch:
      tags: 
        - comments
      summary: Изменение рейтинга комментария.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID комментария
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                liked:
                  type: boolean
                  description: оценка
      responses:
        '200':
          description: Рейтинг успешно обновлен
        '404':
          description: Комментарий не найден
  /wishes:
    post:
      tags: 
        - wishes
      summary: Создание нового желаемого товара.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                userid:
                  type: string
                  description: id пользователя
                phoneid:
                  type: string
                  description: id телефона
      responses:
        '201':
          description: Желаемый товар создан
        '400':
          description: Некорректные данные для создания желаемого товара
  /wishes/{id}:
    delete:
      tags: 
        - wishes
      summary: Удаление желаемого товара.
      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true
          description: ID желаемого товара
      responses:
        '204':
          description: Желаемый товар успешно удален
        '404':
          description: Желаемый товар не найден
tags:
  - name: phones
  - name: users
  - name: orders
  - name: payments
  - name: comments
  - name: wishes
  - name: baskets
